import{p as y,a as b,b as k}from"./pdf.worker-b84ca006.js";import{u as _}from"./Addfile-4e68b33c.js";import{_ as C,e as v,q as h,s as I,r as D,o as R,c as B,a as r,b as E,p as T,h as F}from"./index-5c09f3b2.js";y.GlobalWorkerOptions.workerSrc=b;const M={components:{MySigning:k},setup(){let n=_();const d=e=>new Promise((t,a)=>{const o=new FileReader;o.addEventListener("load",()=>t(n.myPDF=o.result)),o.addEventListener("error",a),o.readAsDataURL(e),n.isUpload=!0,n.myData=o.result}),f=v(""),l=async e=>{e=await d(e);const t=atob(e.substring(e.indexOf(",")+1));console.log(t);const o=await(await y.getDocument({data:t}).promise).getPage(1),p=o.getViewport({scale:window.devicePixelRatio}),c=document.getElementById("canvas");console.log(c);const w=c.getContext("2d");console.log(w),c.height=p.height,c.width=p.width;const P={canvasContext:w,viewport:p};return o.render(P).promise.then(()=>c)},u=async e=>{const t=1/window.devicePixelRatio;return new h.fabric.Image(e,{id:"renderPDF",scaleX:t,scaleY:t})},s=new h.fabric.Canvas("canvas"),g=async e=>{s.requestRenderAll();const t=await l(e.target.files[0]),a=await u(t);s.setWidth(a.width/window.devicePixelRatio),s.setHeight(a.height/window.devicePixelRatio),s.setBackgroundImage(a,s.renderAll.bind(s))},i=_(),x=v("");let m;I(()=>i.isSave,(e,t)=>{console.log(e,t),m=i.isSave,x.value=i.mySign});const S=v(!1);return{signStatus:m,clickModify:()=>{console.log("要修改簽名"),S.value=!0},modifySign:()=>{console.log("修改簽名")},deleteSign:()=>{console.log("刪除簽名")},renderCanvas:g,myData:f}}},A=n=>(T("data-v-79b3d45e"),n=n(),F(),n),L={class:"d-flex flex-row"},V=A(()=>r("canvas",{id:"canvas",width:"500",height:"300"},null,-1));function W(n,d,f,l,u,s){const g=D("my-signing");return R(),B("div",L,[r("div",null,[r("div",null,[r("input",{onChange:d[0]||(d[0]=(...i)=>l.renderCanvas&&l.renderCanvas(...i)),type:"file",accept:"application/pdf"},null,32)]),V]),r("div",null,[E(g)])])}const H=C(M,[["render",W],["__scopeId","data-v-79b3d45e"]]);export{H as default};
